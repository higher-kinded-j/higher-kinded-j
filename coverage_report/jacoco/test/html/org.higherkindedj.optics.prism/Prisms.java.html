<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Prisms.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">hkj-core</a> &gt; <a href="index.source.html" class="el_package">org.higherkindedj.optics.prism</a> &gt; <span class="el_source">Prisms.java</span></div><h1>Prisms.java</h1><pre class="source lang-java linenums">// Copyright (c) 2025 Magnus Smith
// Licensed under the MIT License. See LICENSE.md in the project root for license information.
package org.higherkindedj.optics.prism;

import java.util.Optional;
import org.higherkindedj.hkt.Unit;
import org.higherkindedj.optics.Prism;
import org.jspecify.annotations.NullMarked;

/**
 * Provides standard {@link Prism} instances for common Java types.
 *
 * &lt;p&gt;This class contains factory methods that create {@code Prism} instances for:
 *
 * &lt;ul&gt;
 *   &lt;li&gt;{@link Optional} - focusing on the present case
 * &lt;/ul&gt;
 *
 * &lt;h3&gt;Usage with At:&lt;/h3&gt;
 *
 * &lt;p&gt;The {@link #some()} prism is particularly useful when composing with {@code At} to access
 * values through optional layers:
 *
 * &lt;pre&gt;{@code
 * // Compose At with Prism for deep access
 * Lens&lt;User, Map&lt;String, Address&gt;&gt; addressMapLens = ...;
 * At&lt;Map&lt;String, Address&gt;, String, Address&gt; mapAt = AtInstances.mapAt();
 * Prism&lt;Optional&lt;Address&gt;, Address&gt; somePrism = Prisms.some();
 *
 * // Create a Traversal that focuses on the home address (if present)
 * Traversal&lt;User, Address&gt; homeAddressTraversal =
 *     addressMapLens
 *         .andThen(mapAt.at(&quot;home&quot;))      // Lens&lt;User, Optional&lt;Address&gt;&gt;
 *         .asTraversal()
 *         .andThen(somePrism.asTraversal());
 *
 * // Now you can modify the address if it exists
 * User updatedUser = Traversals.modify(
 *     homeAddressTraversal,
 *     addr -&gt; addr.withCity(&quot;New York&quot;),
 *     user
 * );
 * }&lt;/pre&gt;
 */
@NullMarked
public final class Prisms {

  /** Private constructor to prevent instantiation. */
  private Prisms() {}

  /**
   * Creates a {@link Prism} that focuses on the present case of an {@link Optional}.
   *
   * &lt;p&gt;This prism has the following semantics:
   *
   * &lt;ul&gt;
   *   &lt;li&gt;{@code getOptional(Optional.of(x))} returns {@code Optional.of(x)}
   *   &lt;li&gt;{@code getOptional(Optional.empty())} returns {@code Optional.empty()}
   *   &lt;li&gt;{@code build(x)} returns {@code Optional.of(x)}
   * &lt;/ul&gt;
   *
   * &lt;p&gt;This is useful for composing through optional layers, such as when working with {@code At}
   * which returns {@code Lens&lt;S, Optional&lt;A&gt;&gt;}.
   *
   * @param &lt;A&gt; The type contained in the Optional
   * @return A Prism focusing on the present case of Optional
   */
  public static &lt;A&gt; Prism&lt;Optional&lt;A&gt;, A&gt; some() {
<span class="fc" id="L69">    return Prism.of(opt -&gt; opt, Optional::of);</span>
  }

  /**
   * Creates a {@link Prism} that focuses on the empty case of an {@link Optional}.
   *
   * &lt;p&gt;This prism matches when the Optional is empty:
   *
   * &lt;ul&gt;
   *   &lt;li&gt;{@code getOptional(Optional.empty())} returns {@code Optional.of(Unit.INSTANCE)}
   *   &lt;li&gt;{@code getOptional(Optional.of(x))} returns {@code Optional.empty()}
   *   &lt;li&gt;{@code build(Unit.INSTANCE)} returns {@code Optional.empty()}
   * &lt;/ul&gt;
   *
   * &lt;p&gt;This is less commonly used than {@link #some()}, but can be useful for checking absence.
   *
   * @param &lt;A&gt; The type that would be contained in the Optional (phantom type)
   * @return A Prism focusing on the empty case of Optional
   */
  public static &lt;A&gt; Prism&lt;Optional&lt;A&gt;, Unit&gt; none() {
<span class="fc" id="L89">    return Prism.of(</span>
<span class="fc bfc" id="L90" title="All 2 branches covered.">        opt -&gt; opt.isEmpty() ? Optional.of(Unit.INSTANCE) : Optional.empty(),</span>
<span class="fc" id="L91">        _unit -&gt; Optional.empty());</span>
  }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.13.202504020838</span></div></body></html>
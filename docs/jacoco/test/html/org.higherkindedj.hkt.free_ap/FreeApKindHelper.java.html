<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>FreeApKindHelper.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">hkj-core</a> &gt; <a href="index.source.html" class="el_package">org.higherkindedj.hkt.free_ap</a> &gt; <span class="el_source">FreeApKindHelper.java</span></div><h1>FreeApKindHelper.java</h1><pre class="source lang-java linenums">// Copyright (c) 2025 Magnus Smith
// Licensed under the MIT License. See LICENSE.md in the project root for license information.
package org.higherkindedj.hkt.free_ap;

import org.higherkindedj.hkt.Kind;
import org.higherkindedj.hkt.TypeArity;
import org.higherkindedj.hkt.WitnessArity;
import org.higherkindedj.hkt.exception.KindUnwrapException;
import org.jspecify.annotations.Nullable;

/**
 * Helper for converting between FreeAp and Kind representations.
 *
 * &lt;p&gt;This enum provides utilities for:
 *
 * &lt;ul&gt;
 *   &lt;li&gt;Widening concrete FreeAp types to their Kind representation
 *   &lt;li&gt;Narrowing Kind representations back to concrete FreeAp types
 * &lt;/ul&gt;
 *
 * &lt;p&gt;Access these operations via the singleton {@code FREE_AP}. For example:
 *
 * &lt;pre&gt;{@code
 * FreeApKindHelper.FREE_AP.widen(FreeAp.pure(42));
 * }&lt;/pre&gt;
 *
 * &lt;p&gt;Or, with static import:
 *
 * &lt;pre&gt;{@code
 * import static org.higherkindedj.hkt.free_ap.FreeApKindHelper.FREE_AP;
 * FREE_AP.widen(...);
 * }&lt;/pre&gt;
 */
<span class="fc" id="L34">public enum FreeApKindHelper {</span>
  /** Singleton instance of the FreeApKindHelper. */
<span class="fc" id="L36">  FREE_AP;</span>

  /**
   * Holder record that wraps a FreeAp instance and implements FreeApKind.
   *
   * &lt;p&gt;This enables the concrete FreeAp type to be represented as a Kind.
   *
   * @param &lt;F&gt; The instruction set type
   * @param &lt;A&gt; The result type
   */
  record FreeApHolder&lt;F extends WitnessArity&lt;TypeArity.Unary&gt;, A&gt;(FreeAp&lt;F, A&gt; freeAp)
      implements FreeApKind&lt;F, A&gt; {}

  /**
   * Widens a concrete FreeAp type to its Kind representation.
   *
   * &lt;p&gt;This allows FreeAp to be used with type classes that operate on Kind types.
   *
   * @param freeAp The FreeAp instance to widen. Must not be null.
   * @param &lt;F&gt; The instruction set type
   * @param &lt;A&gt; The result type
   * @return The Kind representation of the FreeAp instance
   * @throws NullPointerException if freeAp is null
   */
  public &lt;F extends WitnessArity&lt;TypeArity.Unary&gt;, A&gt; Kind&lt;FreeApKind.Witness&lt;F&gt;, A&gt; widen(
      FreeAp&lt;F, A&gt; freeAp) {
<span class="fc bfc" id="L62" title="All 2 branches covered.">    if (freeAp == null) {</span>
<span class="fc" id="L63">      throw new NullPointerException(&quot;FreeAp to widen cannot be null&quot;);</span>
    }
<span class="fc" id="L65">    return new FreeApHolder&lt;&gt;(freeAp);</span>
  }

  /**
   * Narrows a Kind representation back to a concrete FreeAp type.
   *
   * &lt;p&gt;This is the inverse of {@link #widen(FreeAp)}.
   *
   * @param kind The Kind representation to narrow. May be null.
   * @param &lt;F&gt; The instruction set type
   * @param &lt;A&gt; The result type
   * @return The concrete FreeAp instance
   * @throws KindUnwrapException if kind is null or not a valid FreeApKind representation
   */
  @SuppressWarnings(&quot;unchecked&quot;)
  public &lt;F extends WitnessArity&lt;TypeArity.Unary&gt;, A&gt; FreeAp&lt;F, A&gt; narrow(
      @Nullable Kind&lt;FreeApKind.Witness&lt;F&gt;, A&gt; kind) {
<span class="fc bfc" id="L82" title="All 2 branches covered.">    if (kind == null) {</span>
<span class="fc" id="L83">      throw new KindUnwrapException(&quot;Cannot narrow null Kind to FreeAp&quot;);</span>
    }
<span class="fc bfc" id="L85" title="All 2 branches covered.">    if (kind instanceof FreeApHolder&lt;?, ?&gt; holder) {</span>
<span class="fc" id="L86">      return (FreeAp&lt;F, A&gt;) holder.freeAp();</span>
    }
<span class="fc" id="L88">    throw new KindUnwrapException(</span>
<span class="fc" id="L89">        &quot;Cannot narrow Kind to FreeAp: expected FreeApHolder but got &quot; + kind.getClass());</span>
  }

  /**
   * Convenience factory that creates a pure FreeAp and wraps it as a Kind.
   *
   * @param value The value to lift
   * @param &lt;F&gt; The instruction set type
   * @param &lt;A&gt; The value type
   * @return A Kind representing FreeAp containing the pure value
   */
  public &lt;F extends WitnessArity&lt;TypeArity.Unary&gt;, A&gt; Kind&lt;FreeApKind.Witness&lt;F&gt;, A&gt; pure(A value) {
<span class="fc" id="L101">    return widen(FreeAp.pure(value));</span>
  }

  /**
   * Convenience factory that lifts a Kind into FreeAp and wraps it as a Kind.
   *
   * @param fa The Kind to lift. Must not be null.
   * @param &lt;F&gt; The instruction set type
   * @param &lt;A&gt; The result type
   * @return A Kind representing FreeAp containing the lifted instruction
   * @throws NullPointerException if fa is null
   */
  public &lt;F extends WitnessArity&lt;TypeArity.Unary&gt;, A&gt; Kind&lt;FreeApKind.Witness&lt;F&gt;, A&gt; lift(
      Kind&lt;F, A&gt; fa) {
<span class="fc" id="L115">    return widen(FreeAp.lift(fa));</span>
  }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.13.202504020838</span></div></body></html>
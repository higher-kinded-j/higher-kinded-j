<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>StateTuple.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">hkj-core</a> &gt; <a href="index.source.html" class="el_package">org.higherkindedj.hkt.state</a> &gt; <span class="el_source">StateTuple.java</span></div><h1>StateTuple.java</h1><pre class="source lang-java linenums">// Copyright (c) 2025 Magnus Smith
// Licensed under the MIT License. See LICENSE.md in the project root for license information.
package org.higherkindedj.hkt.state;

import org.higherkindedj.hkt.Unit;
import org.higherkindedj.hkt.util.validation.Operation;
import org.higherkindedj.hkt.util.validation.Validation;
import org.higherkindedj.optics.annotations.GenerateLenses;
import org.jspecify.annotations.Nullable;

/**
 * A record representing the result of a stateful computation, typically used with the {@link State}
 * monad or {@link org.higherkindedj.hkt.state_t.StateT} monad transformer.
 *
 * &lt;p&gt;A stateful computation, when run, produces a final computed value along with a new (or
 * updated) state. This {@code StateTuple} encapsulates these two pieces of information: the
 * resulting value and the final state.
 *
 * &lt;p&gt;The state component {@code S} is guaranteed to be non-null, as verified by the constructor.
 * The value component {@code A} can be {@code null} if the type {@code A} itself permits null
 * values (e.g., {@code String}). If {@code A} is {@link Unit}, the value will be {@link
 * Unit#INSTANCE}.
 *
 * &lt;p&gt;For example, if a {@code State&lt;S, A&gt;} computation is run with an initial state {@code s0}, it
 * might produce a {@code StateTuple&lt;S, A&gt;(resultValue, s1)}, where {@code resultValue} is the
 * outcome of type {@code A}, and {@code s1} is the new state of type {@code S}.
 *
 * @param &lt;S&gt; The type of the state. This state is guaranteed to be non-null.
 * @param &lt;A&gt; The type of the computed value. This value can be {@code null} if the type {@code A}
 *     supports it (e.g. {@code String}); if {@code A} is {@link Unit}, this will be {@link
 *     Unit#INSTANCE}.
 * @param value The computed value resulting from the stateful operation. May be {@code null} (e.g.,
 *     if {@code A} is {@code String}); if {@code A} is {@link Unit}, this will be {@link
 *     Unit#INSTANCE}.
 * @param state The final state after the stateful operation has been run. Must not be {@code null}.
 * @see State
 * @see org.higherkindedj.hkt.state_t.StateT
 * @see Unit
 */
@GenerateLenses
public record StateTuple&lt;S, A&gt;(@Nullable A value, S state) {

  /**
   * Compact constructor for {@link StateTuple}. Ensures that the {@code state} component is never
   * {@code null}. The {@code value} component can be {@code null} if type {@code A} allows it.
   *
   * @param value The computed value, may be {@code null} (if {@code A} is a nullable type like
   *     {@code String}). If {@code A} is {@link Unit}, this must be {@link Unit#INSTANCE}.
   * @param state The final state, must not be {@code null}.
   * @throws NullPointerException if {@code state} is {@code null}.
   */
<span class="fc" id="L52">  public StateTuple {</span>
<span class="fc" id="L53">    Validation.coreType().requireValue(state, StateTuple.class, Operation.CONSTRUCTION);</span>
<span class="fc" id="L54">  }</span>

  /**
   * Static factory method to create a {@code StateTuple} instance.
   *
   * &lt;p&gt;This provides an alternative way to construct a {@code StateTuple}, potentially offering
   * better type inference in some contexts or a more fluent API style. The order of parameters is
   * (state, value) which might differ from the record's canonical constructor (value, state).
   *
   * @param state The final state. Must not be {@code null}.
   * @param value The final computed value. May be {@code null} (if {@code A} is a nullable type
   *     like {@code String}). If {@code A} is {@link Unit}, this should be {@link Unit#INSTANCE}.
   * @param &lt;S&gt; The type of the state.
   * @param &lt;A&gt; The type of the value.
   * @return A new, non-null {@link StateTuple} instance.
   * @throws NullPointerException if {@code state} is {@code null}.
   */
  public static &lt;S, A&gt; StateTuple&lt;S, A&gt; of(S state, @Nullable A value) {
<span class="fc" id="L72">    Validation.coreType().requireValue(state, StateTuple.class, Operation.OF);</span>
<span class="fc" id="L73">    return new StateTuple&lt;&gt;(value, state);</span>
  }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.13.202504020838</span></div></body></html>